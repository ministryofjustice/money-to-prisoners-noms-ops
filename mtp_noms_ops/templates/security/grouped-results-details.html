{% extends 'base.html' %}
{% load i18n %}
{% load security %}

{% block content %}
  <header class="ContentHeader">
    <a href="{% unserialise_back_url request %}" class="ContentHeader-back">{% trans 'Back' %}</a>
    <h1>{{ view.title }}</h1>
  </header>

  {% include 'mtp_common/includes/message_box.html' %}

  <table>
    <caption></caption>
    <thead>
      <tr>
        <th>{% trans 'Intended recipient' %}</th>
        <th>{% trans 'Prison' %}</th>
        <th>{% trans 'Amount (£)' %}</th>
        <th>{% trans 'Payment method' %}</th>
        <th>{% trans 'Date received' %}</th>
        <th>{% trans 'Processed by' %}</th>
      </tr>
    </thead>
    <tbody>
      {% for credit in credits|parse_date_fields %}
        <tr>
          <td>
            {% if credit.source == 'online' %}
              {{ credit.intended_recipient }}
            {% else %}
              {{ credit.prisoner_name }}
              {% if credit.prisoner_number %}
                (<a href="{% url 'security:credits' %}?page=1&amp;prisoner_number={{ credit.prisoner_number }}">{{ credit.prisoner_number }}</a>)
              {% endif %}
            {% endif %}
          </td>
          <td>{{ credit.prison_name }}</td>
          <td>{{ credit.amount|currency }}</td>
          <td>
            {% if credit.source == 'online' %}
              {% trans 'Debit card' %}
            {% else %}
              {% trans 'Bank transfer' %}
            {% endif %}
          </td>
          <td>{{ credit.received_at|date:'DATE_FORMAT' }}</td>
          <td>{{ credit.owner_name|default_if_none:'—' }}</td>
        </tr>
      {% empty %}
        <tr>
          <td colspan="6">{% trans 'No credits found' %}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>

  {% include 'security/pagination.html' %}

{% endblock content %}
